<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoalCompass | Harada Method</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&family=Noto+Sans+JP:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="chart.js"></script>
</head>

<body>
    <div class="background-globes">
        <div class="globe globe-1"></div>
        <div class="globe globe-2"></div>
        <div class="globe globe-3"></div>
    </div>

    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo">
                <i class="fa-solid fa-compass"></i>
                <span>GoalCompass</span>
            </div>

            <ul class="nav-links" id="nav-links">
                <li class="nav-item active" data-target="dashboard" draggable="true">
                    <i class="fa-solid fa-grip-vertical drag-handle"></i>
                    <i class="fa-solid fa-chart-pie"></i>
                    <span>データベース</span>
                </li>
                <li class="nav-item" data-target="goal-setting" draggable="true">
                    <i class="fa-solid fa-grip-vertical drag-handle"></i>
                    <i class="fa-solid fa-bullseye"></i>
                    <span>目的・目標</span>
                </li>

                <li class="nav-item" data-target="mandala" draggable="true">
                    <i class="fa-solid fa-grip-vertical drag-handle"></i>
                    <i class="fa-solid fa-table-cells"></i>
                    <span>曼荼羅ログ</span>
                </li>
                <!-- ARCHIVED: Supporters and Mental nav items
                <li class="nav-item" data-target="supporters" draggable="true">
                    <i class="fa-solid fa-grip-vertical drag-handle"></i>
                    <i class="fa-solid fa-users"></i>
                    <span>支援者</span>
                </li>
                <li class="nav-item" data-target="mental" draggable="true">
                    <i class="fa-solid fa-grip-vertical drag-handle"></i>
                    <i class="fa-solid fa-brain"></i>
                    <span>メンタル管理</span>
                </li>
                -->
                <li class="nav-item" data-target="routine" draggable="true">
                    <i class="fa-solid fa-grip-vertical drag-handle"></i>
                    <i class="fa-solid fa-list-check"></i>
                    <span>日誌・習慣</span>
                </li>
            </ul>

            <div class="user-profile">
                <div class="avatar">H</div>
                <span>User</span>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">

            <!-- Dashboard Section -->
            <section id="dashboard" class="page-section active">
                <header class="section-header">
                    <h1>データベース</h1>
                    <p>継続的なデータの可視化</p>
                </header>

                <!-- Dashboard Tabs -->
                <div class="dashboard-tabs">
                    <button class="dash-tab-btn active" data-tab="analysis">分析データ</button>
                    <!-- <button class="dash-tab-btn" data-tab="archive">アーカイブ</button> -->
                </div>

                <!-- Analysis Panel (Main) -->
                <div class="dashboard-panel active" id="panel-analysis">
                    <!-- 1. Habit Matrix (Full Width) -->
                    <div class="card matrix-card">
                        <div class="card-header-row">
                            <h3>習慣マトリックス (直近14日間)</h3>
                            <button id="btn-refresh-data" class="icon-btn" title="データ更新"><i
                                    class="fa-solid fa-arrows-rotate"></i></button>
                        </div>
                        <div class="matrix-container" id="habit-matrix-view">
                            <div class="loading-spinner">Loading data...</div>
                        </div>
                    </div>

                    <div class="dashboard-grid-2col">
                        <!-- 3. Streak & Stats -->
                        <div class="card stats-card">
                            <h3>継続ストリーク</h3>
                            <div class="streak-list" id="streak-list-view">
                                <!-- Generated by JS -->
                            </div>
                        </div>

                        <!-- 2. Balance Radar -->
                        <div class="card chart-card">
                            <h3>心技体バランス (週間平均)</h3>
                            <div class="chart-container">
                                <canvas id="radarChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Archived Widgets (Hidden by default or moved here) -->
                <!-- 
                <div class="dashboard-grid archive-section" style="display:none;">
                    <div class="card main-goal-card">...</div>
                    <div class="card routine-summary-card">...</div>
                    <div class="card motivation-card">...</div>
                </div>
                -->
            </section>

            <!-- Goal Setting Section -->
            <section id="goal-setting" class="page-section">
                <header class="section-header">
                    <h1>目的・目標設定</h1>
                    <p>目標とKPIをしっかり確認しよう！</p>
                </header>

                <div class="goal-form-container">

                    <!-- AI Assistant Banner (ARCHIVED)
                    <div class="ai-assistant-banner" id="btn-open-ai-wizard">
                        <div class="ai-icon"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                        <div class="ai-text">
                            <h3>AIアシスタントで目標を設定</h3>
                            <p>5つの質問に答えるだけで、目標と4観点を自動生成します</p>
                        </div>
                        <i class="fa-solid fa-chevron-right"></i>
                    </div>
                    -->

                    <div class="card main-input-group" style="margin-top: 1.5rem;">
                        <label>達成したい目標（メインテーマ）</label>
                        <textarea id="goal-input" rows="3" placeholder="例：2026年3月までに売上2000万円を達成する"
                            style="resize: vertical;"></textarea>

                        <label>達成期日</label>
                        <input type="date" id="deadline-input">
                    </div>

                    <!-- ARCHIVED: Milestone Section (uncomment to restore)
                    <div class="card milestone-section">
                        <div class="section-header-small">
                            <h3><i class="fa-solid fa-stairs"></i> 目標ブレークダウン (マイルストーン)</h3>
                            <p class="description">年間目標をステップごとに数値化・可視化しましょう。AIアシスタントが提案します。</p>
                        </div>
                        <div class="milestone-grid">
                            <div class="milestone-item">
                                <label>3日後 (Sprint)</label>
                                <textarea id="milestone-3days" placeholder="まずはここから..."></textarea>
                            </div>
                            <div class="milestone-item">
                                <label>1週間後</label>
                                <textarea id="milestone-1week" placeholder="1週間の成果..."></textarea>
                            </div>
                            <div class="milestone-item">
                                <label>1ヶ月後</label>
                                <textarea id="milestone-1month" placeholder="習慣化の目安..."></textarea>
                            </div>
                            <div class="milestone-item">
                                <label>3ヶ月後</label>
                                <textarea id="milestone-3months" placeholder="四半期の成果..."></textarea>
                            </div>
                            <div class="milestone-item">
                                <label>半年後</label>
                                <textarea id="milestone-6months" placeholder="折り返し地点..."></textarea>
                            </div>
                            <div class="milestone-item">
                                <label>1年後 (最終目標)</label>
                                <textarea id="milestone-1year" placeholder="目標達成！"></textarea>
                            </div>
                        </div>
                    </div>
                    -->

                    <!-- KPI Section (SMART - Measurable) -->
                    <div class="card kpi-section">
                        <div class="section-header-small">
                            <h3><i class="fa-solid fa-chart-line"></i> KPI設定（数値で測定可能な指標）</h3>
                            <p class="description">定期的に測定できる数値目標を設定。進捗をグラフで可視化します。</p>
                        </div>
                        <div class="kpi-grid" id="kpi-container">
                            <!-- KPIs will be dynamically generated by JS -->
                        </div>
                        <button class="btn-add-kpi" id="add-kpi-btn">
                            <i class="fa-solid fa-plus"></i> KPIを追加
                        </button>
                    </div>

                    <!-- ARCHIVED: 4観点カード (uncomment to restore)
                    <div class="four-view-grid">
                        <div class="view-card self-tangible">
                            <div class="card-header">
                                <i class="fa-solid fa-gift"></i>
                                <span>私・有形</span>
                            </div>
                            <p class="description">自分に与えられる形のある成果（お金、物など）</p>
                            <textarea id="view-self-tangible" placeholder="例：インセンティブで新しいPCを買う"></textarea>
                        </div>

                        <div class="view-card self-intangible">
                            <div class="card-header">
                                <i class="fa-solid fa-heart"></i>
                                <span>私・無形</span>
                            </div>
                            <p class="description">自分自身の心やスキルの変化（自信、知識など）</p>
                            <textarea id="view-self-intangible" placeholder="例：プレゼンへの苦手意識がなくなり、自信がつく"></textarea>
                        </div>

                        <div class="view-card society-tangible">
                            <div class="card-header">
                                <i class="fa-solid fa-building"></i>
                                <span>他者/社会・有形</span>
                            </div>
                            <p class="description">他者に提供できる形のある成果（売上、技術など）</p>
                            <textarea id="view-society-tangible" placeholder="例：チームの年間目標達成に貢献する"></textarea>
                        </div>

                        <div class="view-card society-intangible">
                            <div class="card-header">
                                <i class="fa-solid fa-users"></i>
                                <span>他者/社会・無形</span>
                            </div>
                            <p class="description">他者に与える目に見えない影響（信頼、感動など）</p>
                            <textarea id="view-society-intangible" placeholder="例：後輩が「自分もやりたい」と目標を持ってくれる"></textarea>
                        </div>
                    </div>
                    -->

                    <button class="btn-primary" id="save-goal-btn">
                        <i class="fa-solid fa-save"></i> 設定を保存
                    </button>
                </div>
            </section>



            <!-- Mandala Section -->
            <section id="mandala" class="page-section">
                <header class="section-header">
                    <h1>曼荼羅ログ</h1>
                    <p>目標を具体的行動へ分解</p>
                </header>

                <div class="mandala-container">
                    <!-- The 9x9 Grid will be generated by JS -->
                    <div id="mandala-grid" class="mandala-grid"></div>
                </div>
            </section>


            <!--
            =====================================================
            ARCHIVED: Supporters & Mental Control Sections
            (These sections are commented out. Restore from git if needed.)
            =====================================================
            -->





            <section id="routine" class="page-section">
                <header class="section-header">
                    <h1>日誌・習慣ログ</h1>
                    <p>毎日の習慣チェックと振り返りをまとめて記録</p>
                </header>

                <!-- INTEGRATED HABIT GRID -->
                <div class="habit-grid" style="margin-bottom: 2rem;">
                    <!-- Sleep -->
                    <div class="habit-card card" id="card-sleep">
                        <div class="habit-header">
                            <div class="header-left">
                                <span class="habit-icon"><i class="fa-solid fa-bed"></i></span>
                                <h3>早寝早起き</h3>
                            </div>
                            <button class="rest-btn" data-habit="sleep" title="今日はお休み"><i
                                    class="fa-solid fa-moon"></i></button>
                        </div>
                        <div class="habit-body">
                            <div class="field-group">
                                <label>起床時間</label>
                                <select id="habit-wakeup" class="habit-input"></select>
                            </div>
                            <div class="field-group">
                                <label>就寝時間</label>
                                <select id="habit-bedtime" class="habit-input"></select>
                            </div>
                        </div>
                    </div>

                    <!-- English -->
                    <div class="habit-card card" id="card-english">
                        <div class="habit-header">
                            <div class="header-left">
                                <span class="habit-icon"><i class="fa-solid fa-language"></i></span>
                                <h3>英語学習</h3>
                            </div>
                            <button class="rest-btn" data-habit="english" title="今日はお休み"><i
                                    class="fa-solid fa-moon"></i></button>
                        </div>
                        <div class="habit-body">
                            <div class="field-group">
                                <label>学習内容 (複数選択可)</label>
                                <div class="chip-container editable" id="habit-english-content">
                                    <span class="chip" data-value="単語">単語<button class="chip-delete">×</button></span>
                                    <span class="chip" data-value="リスニング">リスニング<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="リーディング">リーディング<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="スピーキング">スピーキング<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="オンライン英会話">オンライン英会話<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="試験対策">試験対策<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="その他">その他<button class="chip-delete">×</button></span>
                                    <button class="chip-add" data-container="habit-english-content"><i
                                            class="fa-solid fa-plus"></i></button>
                                </div>
                            </div>

                            <!-- Dynamic Details Container (like muscle training) -->
                            <div id="english-details-container" class="english-details-container"></div>

                            <div class="field-group">
                                <label>その他メモ</label>
                                <textarea id="habit-english-memo" class="habit-input"
                                    placeholder="その他の学習内容やメモがあればこちらに..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Muscle Training -->
                    <div class="habit-card card" id="card-muscle">
                        <div class="habit-header">
                            <div class="header-left">
                                <span class="habit-icon"><i class="fa-solid fa-dumbbell"></i></span>
                                <h3>筋トレ</h3>
                            </div>
                            <button class="rest-btn" data-habit="muscle" title="今日はお休み"><i
                                    class="fa-solid fa-moon"></i></button>
                        </div>
                        <div class="habit-body">
                            <div class="field-group">
                                <label>種目を選択 (複数選択可)</label>
                                <div class="chip-container editable" id="habit-muscle-menu">
                                    <span class="chip" data-value="ベンチプレス">ベンチプレス<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="ケーブルカール">ケーブルカール<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="スクワット">スクワット<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="ディップス">ディップス<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="懸垂">懸垂<button class="chip-delete">×</button></span>
                                    <span class="chip" data-value="デッドリフト">デッドリフト<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="その他">その他<button class="chip-delete">×</button></span>
                                    <button class="chip-add" data-container="habit-muscle-menu"><i
                                            class="fa-solid fa-plus"></i></button>
                                </div>
                            </div>

                            <!-- Dynamic Details Container -->
                            <div id="muscle-details-container" class="muscle-details-container"></div>

                            <div class="field-group">
                                <label>その他メモ</label>
                                <textarea id="habit-muscle-detail" class="habit-input"
                                    placeholder="その他の種目やメモがあればこちらに..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Jogging -->
                    <div class="habit-card card" id="card-jogging">
                        <div class="habit-header">
                            <div class="header-left">
                                <span class="habit-icon"><i class="fa-solid fa-person-running"></i></span>
                                <h3>ジョギング</h3>
                            </div>
                            <button class="rest-btn" data-habit="jogging" title="今日はお休み"><i
                                    class="fa-solid fa-moon"></i></button>
                        </div>
                        <div class="habit-body">
                            <div class="field-group">
                                <label>走行距離</label>
                                <div class="slider-group">
                                    <div class="slider-display">
                                        <input type="number" id="input-jogging-dist" class="slider-value-input"
                                            step="0.1" min="0" max="50" value="0">
                                        <span class="slider-unit">km</span>
                                    </div>
                                    <div class="slider-controls">
                                        <button class="slider-btn minus" data-target="habit-jogging-dist"
                                            data-step="0.1"><i class="fa-solid fa-minus"></i></button>
                                        <input type="range" id="habit-jogging-dist" class="habit-slider" step="0.1"
                                            min="0" max="20" value="0">
                                        <button class="slider-btn plus" data-target="habit-jogging-dist"
                                            data-step="0.1"><i class="fa-solid fa-plus"></i></button>
                                    </div>
                                </div>
                            </div>
                            <div class="field-group">
                                <label>タイム</label>
                                <div class="slider-group">
                                    <div class="slider-display">
                                        <input type="number" id="input-jogging-time" class="slider-value-input" step="1"
                                            min="0" max="300" value="0">
                                        <span class="slider-unit">分</span>
                                    </div>
                                    <div class="slider-controls">
                                        <button class="slider-btn minus" data-target="habit-jogging-time"
                                            data-step="1"><i class="fa-solid fa-minus"></i></button>
                                        <input type="range" id="habit-jogging-time" class="habit-slider" step="1"
                                            min="0" max="120" value="0">
                                        <button class="slider-btn plus" data-target="habit-jogging-time"
                                            data-step="1"><i class="fa-solid fa-plus"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Mental Care -->
                    <div class="habit-card card" id="card-mental">
                        <div class="habit-header">
                            <div class="header-left">
                                <span class="habit-icon"><i class="fa-solid fa-spa"></i></span>
                                <h3>メンタルケア</h3>
                            </div>
                            <button class="rest-btn" data-habit="mental" title="今日はお休み"><i
                                    class="fa-solid fa-moon"></i></button>
                        </div>
                        <div class="habit-body">
                            <div class="mental-care-grid">
                                <label class="mental-care-item">
                                    <input type="checkbox" id="habit-mental-nap">
                                    <span class="mental-care-label">昼寝</span>
                                </label>
                                <label class="mental-care-item">
                                    <input type="checkbox" id="habit-mental-meditation">
                                    <span class="mental-care-label">瞑想</span>
                                </label>
                                <label class="mental-care-item">
                                    <input type="checkbox" id="habit-mental-stretch">
                                    <span class="mental-care-label">ストレッチ</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Social Media -->
                    <div class="habit-card card" id="card-social">
                        <div class="habit-header">
                            <div class="header-left">
                                <span class="habit-icon"><i class="fa-solid fa-share-nodes"></i></span>
                                <h3>発信活動</h3>
                            </div>
                            <button class="rest-btn" data-habit="social" title="今日はお休み"><i
                                    class="fa-solid fa-moon"></i></button>
                        </div>
                        <div class="habit-body">
                            <div class="field-group">
                                <label>実施した項目 (複数選択可)</label>
                                <div class="chip-container editable" id="habit-social-menu">
                                    <span class="chip" data-value="note">note<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="X">X<button class="chip-delete">×</button></span>
                                    <span class="chip" data-value="Youtube">Youtube<button
                                            class="chip-delete">×</button></span>
                                    <span class="chip" data-value="ラジオ">ラジオ<button class="chip-delete">×</button></span>
                                    <button class="chip-add" data-container="habit-social-menu"><i
                                            class="fa-solid fa-plus"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ARCHIVED: Routine Matrix Table (uncomment to restore)
                <div class="card routine-matrix-card">
                    <div class="card-header-row">
                        <h3><i class="fa-solid fa-list-check"></i> ルーティンチェック表 (直近2週間)</h3>
                        <div class="matrix-legend">
                            <span><i class="fa-solid fa-circle-check"></i> 達成</span>
                            <span><i class="fa-solid fa-minus"></i> 未達成</span>
                        </div>
                    </div>

                    <div class="matrix-overflow-container">
                        <table class="routine-matrix" id="routine-matrix">
                        </table>
                    </div>

                    <div class="add-routine-wrapper">
                        <input type="text" id="new-routine-input" placeholder="新しいルーティンを追加 (例: 毎朝7時に起きる)...">
                        <button id="add-routine-btn"><i class="fa-solid fa-plus"></i> 追加</button>
                    </div>
                </div>
                -->

                <!-- Daily Journal -->
                <div class="journal-wrapper card">
                    <header class="journal-header-compact">
                        <div class="date-nav-compact">
                            <button id="prev-date"><i class="fa-solid fa-chevron-left"></i></button>
                            <input type="date" id="journal-date" class="date-input-transparent">
                            <button id="next-date"><i class="fa-solid fa-chevron-right"></i></button>
                        </div>
                        <div class="save-status" id="journal-status"></div>
                    </header>

                    <div class="journal-content-grid">
                        <!-- Left Col: Morning & Intention -->
                        <div class="journal-body">
                            <!-- Section: Morning Plan -->
                            <div class="journal-part-header"><i class="fa-regular fa-sun"></i> 朝の計画 (Morning)</div>

                            <div class="form-group">
                                <label class="section-label">今日の一言 (Daily Declaration)</label>
                                <input type="text" id="journal-declaration" class="journal-input"
                                    placeholder="例：仕事は締切の2日前までに仕上げるぞ！" style="width: 100%; font-weight:bold;">
                            </div>

                            <div class="split-view-grid">
                                <div class="split-col">
                                    <div class="label-with-action">
                                        <label class="section-label"><i class="fa-regular fa-calendar"></i>
                                            今日のスケジュール</label>
                                        <button id="btn-get-schedule" class="btn-xs"
                                            title="GASでGoogle Calendar APIを有効にする必要があります"><i
                                                class="fa-solid fa-sync"></i>
                                            取得</button>
                                    </div>
                                    <textarea id="journal-calendar" class="journal-textarea sub-textarea"
                                        placeholder="・10:00 会議..."></textarea>
                                </div>
                                <div class="split-col">
                                    <label class="section-label"><i class="fa-solid fa-list-check"></i> 今日必ずやること
                                        (To-Do)</label>
                                    <textarea id="journal-todo" class="journal-textarea sub-textarea"
                                        placeholder="1. 提案書作成&#10;2. 部下との面談..."></textarea>
                                </div>
                            </div>

                            <!-- Section: Evening Review -->
                            <div class="journal-part-header" style="margin-top:2rem;"><i class="fa-regular fa-moon"></i>
                                夜の振り返り (Evening)</div>

                            <div class="form-group">
                                <label class="section-label">今日の行動の評価 (Score)</label>
                                <p class="score-description">今日1日を心・技・体・生活の4つの観点から振り返ろう</p>
                                <div class="score-grid playful">
                                    <div class="score-item-playful">
                                        <div class="score-label">
                                            <span>心</span>
                                        </div>
                                        <div class="star-row">
                                            <span class="star-hint">Low</span>
                                            <div class="star-rating" data-target="score-heart">
                                                <span class="star" data-value="1">★</span>
                                                <span class="star" data-value="2">★</span>
                                                <span class="star" data-value="3">★</span>
                                                <span class="star" data-value="4">★</span>
                                                <span class="star" data-value="5">★</span>
                                            </div>
                                            <span class="star-hint">High</span>
                                        </div>
                                        <input type="hidden" id="score-heart" value="5">
                                    </div>
                                    <div class="score-item-playful">
                                        <div class="score-label">
                                            <span>技</span>
                                        </div>
                                        <div class="star-row">
                                            <span class="star-hint">Low</span>
                                            <div class="star-rating" data-target="score-skill">
                                                <span class="star" data-value="1">★</span>
                                                <span class="star" data-value="2">★</span>
                                                <span class="star" data-value="3">★</span>
                                                <span class="star" data-value="4">★</span>
                                                <span class="star" data-value="5">★</span>
                                            </div>
                                            <span class="star-hint">High</span>
                                        </div>
                                        <input type="hidden" id="score-skill" value="5">
                                    </div>
                                    <div class="score-item-playful">
                                        <div class="score-label">
                                            <span>体</span>
                                        </div>
                                        <div class="star-row">
                                            <span class="star-hint">Low</span>
                                            <div class="star-rating" data-target="score-body">
                                                <span class="star" data-value="1">★</span>
                                                <span class="star" data-value="2">★</span>
                                                <span class="star" data-value="3">★</span>
                                                <span class="star" data-value="4">★</span>
                                                <span class="star" data-value="5">★</span>
                                            </div>
                                            <span class="star-hint">High</span>
                                        </div>
                                        <input type="hidden" id="score-body" value="5">
                                    </div>
                                    <div class="score-item-playful">
                                        <div class="score-label">
                                            <span>生活</span>
                                        </div>
                                        <div class="star-row">
                                            <span class="star-hint">Low</span>
                                            <div class="star-rating" data-target="score-life">
                                                <span class="star" data-value="1">★</span>
                                                <span class="star" data-value="2">★</span>
                                                <span class="star" data-value="3">★</span>
                                                <span class="star" data-value="4">★</span>
                                                <span class="star" data-value="5">★</span>
                                            </div>
                                            <span class="star-hint">High</span>
                                        </div>
                                        <input type="hidden" id="score-life" value="5">
                                    </div>
                                </div>
                            </div>

                            <div class="split-view-grid">
                                <div class="split-col">
                                    <label class="section-label">今日もう一度やり直せるとしたら</label>
                                    <textarea id="journal-redo" class="journal-textarea medium"
                                        placeholder="例：好きな人に告白する"></textarea>
                                </div>
                                <div class="split-col">
                                    <label class="section-label">今日自信を育てた出来事 (Good)</label>
                                    <textarea id="journal-confidence" class="journal-textarea medium"
                                        placeholder="例：カッコよくなったねと言われる"></textarea>
                                </div>
                            </div>

                            <div class="form-section">
                                <label class="section-label"><i class="fa-solid fa-pen-nib"></i> 自由記述日誌
                                    (Thoughts)</label>
                                <textarea id="journal-textarea" class="journal-textarea main-diary"
                                    placeholder="感想、気づき、改善点など..."></textarea>
                            </div>

                            <div class="form-group" style="margin-top: 1rem;">
                                <div class="label-with-action">
                                    <label class="section-label">今日のアクティビティ履歴 (Evidence)</label>
                                    <button id="btn-get-history" class="btn-xs"><i
                                            class="fa-solid fa-clock-rotate-left"></i>
                                        履歴検索</button>
                                </div>
                                <textarea id="journal-activity" class="journal-textarea sub-textarea"
                                    placeholder="履歴を自動取得、または手動で追記..."></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="journal-actions">
                        <div class="act-left">
                            <button id="btn-temp-save" class="btn-outline">一時保存</button>
                            <button id="btn-ai-format" class="btn-text" title="AIで文章を整える"><i
                                    class="fa-solid fa-wand-magic-sparkles"></i> AI整形</button>
                        </div>
                        <button id="btn-save-sync" class="btn-primary"><i class="fa-solid fa-cloud-arrow-up"></i> 保存 &
                            同期</button>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- AI Wizard Modal -->
    <div id="ai-wizard-modal" class="modal-overlay">
        <div class="modal wizard-modal">
            <div class="wizard-header">
                <h2><i class="fa-solid fa-robot"></i> 目標設定アシスタント</h2>
                <div class="step-indicator">
                    <span class="step active">1</span>
                    <span class="step">2</span>
                    <span class="step">3</span>
                    <span class="step">4</span>
                    <span class="step">5</span>
                </div>
            </div>

            <div class="wizard-content" id="wizard-content">
                <!-- Slides will be injected dynamically -->
            </div>

            <div class="wizard-footer">
                <div style="display: flex; gap: 10px;">
                    <button id="btn-wiz-cancel" class="btn-secondary">キャンセル</button>
                    <button id="btn-wiz-save" class="btn-secondary"
                        style="color: var(--accent-gold); border-color: var(--accent-gold);"><i
                            class="fa-solid fa-floppy-disk"></i> 一時保存</button>
                </div>
                <div style="display:flex; gap:10px;">
                    <button id="btn-wiz-prev" class="btn-secondary" style="display:none;">戻る</button>
                    <button id="btn-wiz-next" class="btn-primary">次へ <i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal-overlay">
        <div class="modal">
            <h2><i class="fa-solid fa-gear"></i> 設定</h2>

            <div class="form-group">
                <label>GAS Web App URL (データを送信)</label>
                <input type="text" id="config-gas-url" style="width: 100%;"
                    placeholder="https://script.google.com/macros/s/...">
            </div>

            <div class="form-group">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label>スプレッドシート URL</label>
                    <a id="link-ss-url" href="#" target="_blank"
                        style="font-size: 0.8rem; color: var(--accent-gold); text-decoration: none; display: none;">
                        <i class="fa-solid fa-external-link-alt"></i> 開く
                    </a>
                </div>
                <input type="text" id="config-ss-url" style="width: 100%;"
                    placeholder="https://docs.google.com/spreadsheets/d/...">
            </div>

            <div class="form-group">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label>NotebookLM URL</label>
                    <a id="link-notebook-url" href="#" target="_blank"
                        style="font-size: 0.8rem; color: var(--accent-gold); text-decoration: none; display: none;">
                        <i class="fa-solid fa-external-link-alt"></i> 開く
                    </a>
                </div>
                <input type="text" id="config-notebook-url" style="width: 100%;"
                    placeholder="https://notebooklm.google.com/notebook/...">
            </div>

            <div class="form-group">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <label>Gemini API Key (AI整形用)</label>
                    <a href="https://aistudio.google.com/app/api-keys" target="_blank"
                        style="font-size: 0.8rem; color: var(--accent-gold); text-decoration: none;">
                        <i class="fa-solid fa-external-link-alt"></i> キーを取得
                    </a>
                </div>
                <input type="password" id="config-gemini-key" style="width: 100%;" placeholder="AIza...">
            </div>

            <div class="form-group">
                <label>AI整形プロンプト (任意)</label>
                <textarea id="config-custom-prompt" style="width: 100%; height: 100px; font-size: 0.9rem;"
                    placeholder="デフォルト: 以下の日記テキストを読みやすく整形し..."></textarea>
            </div>

            <div style="display: flex; justify-content: flex-end; margin-top: 2rem;">
                <button id="btn-close-settings" class="btn-secondary">キャンセル</button>
                <button id="btn-save-settings" class="btn-primary">保存</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>